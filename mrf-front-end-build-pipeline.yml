# Name of the pipeline
name: MRF-Front-End-Build-Pipeline
appendCommitMessageToRunName: false

# Define the trigger for the pipeline to run when changes occur in azure-pipelines branch
trigger:
- web_mrf

# Use the latest Ubuntu image as the build agent pool
pool:
  vmImage: ubuntu-latest

# Define variables for the source and build directories
variables:
# uiSource: 'Frontend'
  uiSource: 'web'
  uiBuild: '$(uiSource)/build'

# Define the sequence of steps to execute in the pipeline
steps:
- task: NodeTool@0
  inputs:
    versionSpec: '14.x'
  displayName: 'Install Node.js' # Displayed name for the step

- script: |
    cd $(uiSource) # Change directory to the specified source
    npm install    # Install dependencies
    npm run build  # Build the application
  displayName: 'npm install and build' # Displayed name for the step

# - task: ArchiveFiles@2
#   inputs:
#     rootFolderOrFile: '$(uiBuild)' # Set the root folder or file to be archived
#     includeRootFolder: false        # Exclude the root folder from the archive
#     archiveType: 'zip'              # Define the archive type as ZIP
#     archiveFile: '$(Build.ArtifactStagingDirectory)/$(Build.BuildId).zip' # Define the archive file path
#     replaceExistingArchive: true    # Replace the existing archive, if any

- task: PublishBuildArtifacts@1
  inputs:
    pathtoPublish: '$(Build.ArtifactStagingDirectory)' # Set the path to publish artifacts
    artifactName: 'MRF-Main-UI-Artifact'             # Define the name for the artifact
    publishLocation: 'Container'     # Publish artifacts to the build container
